{"ast":null,"code":"import { AUTH_FAILED, AUTH_SUCCESS, SIGNUP_SUCCESS, AUTH_ATTEMPTING, USER_LOGOUT, PROFILE_FETCHED, RESET_SIGNUP } from './types';\nimport { apiLogin, fetchProfile, apiSignUp } from '../api/user';\nimport setAuthHeader from '../api/setAuthHeader';\nconst TOKEN_NAME = 'expense_app_token';\nexport const signIn = request_data => {\n  return async dispatch => {\n    dispatch({\n      type: AUTH_ATTEMPTING\n    });\n\n    try {\n      const {\n        data\n      } = await apiLogin(request_data);\n      setAuthHeader(data.token);\n      dispatch(getProfile());\n      dispatch(success(data.token));\n    } catch (e) {\n      const {\n        response: {\n          data\n        }\n      } = e;\n      dispatch(error(data.error));\n    }\n  };\n};\nexport const resetSignup = () => ({\n  type: RESET_SIGNUP\n});\nexport const signUp = request_data => {\n  return async dispatch => {\n    try {\n      await apiSignUp(request_data);\n      dispatch({\n        type: SIGNUP_SUCCESS\n      });\n    } catch (e) {\n      const {\n        response: {\n          data\n        }\n      } = e;\n      dispatch(error(data.error));\n    }\n  };\n};\nexport const onLoadingSignIn = () => {\n  return dispatch => {\n    try {\n      const token = localStorage.getItem(TOKEN_NAME);\n\n      if (localStorage.getItem(TOKEN_NAME) === localStorage.getItem(TOKEN_NAME) || token === 'undefined') {\n        return dispatch(error('You need to login'));\n      }\n\n      setAuthHeader(token);\n      dispatch(getProfile());\n      dispatch(success(token));\n    } catch (e) {\n      console.log(e);\n    }\n  };\n};\nexport const getProfile = () => {\n  return async dispatch => {\n    try {\n      const {\n        data: {\n          user\n        }\n      } = await fetchProfile();\n      dispatch({\n        type: PROFILE_FETCHED,\n        payload: user\n      });\n    } catch (e) {\n      console.error(e);\n    }\n  };\n};\nexport const logOut = () => {\n  localStorage.clear();\n  return {\n    type: USER_LOGOUT\n  };\n};\n\nconst success = token => {\n  localStorage.setItem(TOKEN_NAME, token);\n  return {\n    type: AUTH_SUCCESS\n  };\n};\n\nconst error = error => {\n  return {\n    type: AUTH_FAILED,\n    payload: error\n  };\n};","map":{"version":3,"sources":["C:/Users/ahmed/Documents/mern-expense-app/client/src/actions/auth_actions.js"],"names":["AUTH_FAILED","AUTH_SUCCESS","SIGNUP_SUCCESS","AUTH_ATTEMPTING","USER_LOGOUT","PROFILE_FETCHED","RESET_SIGNUP","apiLogin","fetchProfile","apiSignUp","setAuthHeader","TOKEN_NAME","signIn","request_data","dispatch","type","data","token","getProfile","success","e","response","error","resetSignup","signUp","onLoadingSignIn","localStorage","getItem","console","log","user","payload","logOut","clear","setItem"],"mappings":"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","sourcesContent":["import { AUTH_FAILED, AUTH_SUCCESS, SIGNUP_SUCCESS, AUTH_ATTEMPTING, USER_LOGOUT, PROFILE_FETCHED, RESET_SIGNUP } from './types'\r\nimport { apiLogin, fetchProfile, apiSignUp } from '../api/user';\r\nimport setAuthHeader from '../api/setAuthHeader';\r\n\r\nconst TOKEN_NAME = 'expense_app_token';\r\nexport const signIn = request_data => {\r\n    return async dispatch => {\r\n        dispatch({ type: AUTH_ATTEMPTING })\r\n        try {\r\n            const { data } = await apiLogin(request_data)\r\n            setAuthHeader(data.token)\r\n            dispatch(getProfile());\r\n            dispatch(success(data.token))\r\n        } catch (e) {\r\n            const { response: { data } } = e\r\n            dispatch(error(data.error))\r\n        }\r\n    };\r\n};\r\n\r\nexport const resetSignup = () => ({ type: RESET_SIGNUP });\r\n\r\n\r\nexport const signUp = request_data => {\r\n    return async dispatch => {\r\n      try {\r\n        await apiSignUp(request_data);\r\n        dispatch({ type: SIGNUP_SUCCESS });\r\n      } catch (e) {\r\n        const {\r\n          response: { data },\r\n        } = e;\r\n        dispatch(error(data.error));\r\n      }\r\n    };\r\n  };\r\n\r\n\r\nexport const onLoadingSignIn = () => {\r\n    return dispatch => {\r\n        try {\r\n            const token = localStorage.getItem(TOKEN_NAME);\r\n            if (localStorage.getItem(TOKEN_NAME) === localStorage.getItem(TOKEN_NAME) || token === 'undefined') {\r\n                return dispatch(error('You need to login'));\r\n            }\r\n            setAuthHeader(token)\r\n            dispatch(getProfile())\r\n            dispatch(success(token))\r\n        } catch (e) {\r\n            console.log(e)\r\n        }\r\n    }\r\n}\r\n\r\n\r\nexport const getProfile = () => {\r\n    return async dispatch => {\r\n        try {\r\n            const { data: { user } } = await fetchProfile()\r\n            dispatch({type:PROFILE_FETCHED, payload: user})\r\n        } catch (e) {\r\n            console.error(e)\r\n        }\r\n    }\r\n}\r\n\r\n\r\nexport const logOut = () => {\r\n    localStorage.clear()\r\n    return ({ type: USER_LOGOUT })\r\n}\r\n\r\n\r\n\r\nconst success = (token) => {\r\n    localStorage.setItem(TOKEN_NAME, token)\r\n    return { type: AUTH_SUCCESS }\r\n};\r\nconst error = (error) => {\r\n    return { type: AUTH_FAILED, payload: error }\r\n};"]},"metadata":{},"sourceType":"module"}